<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Text Renderer Test - zCLI BifrostClient</title>
  
  <!-- zTheme CSS (CDN with cache-busting) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ZoloAi/zTheme@main/dist/ztheme.css?v=20251218">
  
  <style>
    /* ONLY body background - NO component styles! */
    body {
      background: #f8f9fa;
      min-height: 100vh;
    }
    
    /* Log styling (not for zTheme components) */
    #log {
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 0.875rem;
      max-height: 300px;
      overflow-y: auto;
    }
    .log-entry {
      padding: 0.25rem 0.5rem;
      border-bottom: 1px solid #e9ecef;
    }
    .log-success { color: #198754; }
    .log-error { color: #dc3545; }
    .log-info { color: #0d6efd; }
  </style>
</head>
<body>
  <!-- Main Container (zTheme) -->
  <div class="zContainer zMy-4">
    
    <!-- Header Card -->
    <div class="zCard zMb-4">
      <div class="zCard-body">
        <h1 class="zCard-title">Text Renderer Test</h1>
        <p class="zCard-text zText-muted">
          Micro-Step 1: Testing the simplest zDisplay primitive (text events)
        </p>
      </div>
    </div>

    <!-- Test Controls Card -->
    <div class="zCard zMb-4">
      <div class="zCard-body">
        <h2 class="zCard-title zH5">Test Controls</h2>
        <div class="zD-flex zFlex-wrap zGap-2">
          <button class="zBtn zBtn-outline-primary" onclick="testBasicText()">Test Basic Text</button>
          <button class="zBtn zBtn-outline-success" onclick="testColors()">Test All Colors</button>
          <button class="zBtn zBtn-outline-info" onclick="testIndent()">Test Indent Levels</button>
          <button class="zBtn zBtn-outline-warning" onclick="testCustomClass()">Test Custom Class</button>
          <button class="zBtn zBtn-outline-secondary" onclick="testMixed()">Test Mixed</button>
          <button class="zBtn zBtn-outline-danger" onclick="clearRenderZone()">Clear Zone</button>
        </div>
      </div>
    </div>

    <!-- Render Zone Card -->
    <div class="zCard zMb-4">
      <div class="zCard-body">
        <h2 class="zCard-title zH5">Render Zone</h2>
        <div id="render-zone" class="zP-3 zBg-light zBorder zRounded">
          <!-- Text will render here -->
          <p class="zText-muted"><em>Click a test button to render text...</em></p>
        </div>
      </div>
    </div>

    <!-- Log Card -->
    <div class="zCard">
      <div class="zCard-body">
        <h2 class="zCard-title zH5">Console Log</h2>
        <div id="log" class="zP-3 zBg-light zBorder zRounded">
          <!-- Logs will appear here -->
        </div>
      </div>
    </div>

  </div>

  <!-- Scripts (ES6 Modules) -->
  <script type="module">
    import { TextRenderer } from '../src/rendering/text_renderer.js';

    // Mock logger that outputs to both console and on-page log
    const mockLogger = {
      log: (msg) => {
        console.log(msg);
        addLog(msg, 'info');
      },
      error: (msg) => {
        console.error(msg);
        addLog(msg, 'error');
      },
      warn: (msg) => {
        console.warn(msg);
        addLog(msg, 'error');
      }
    };

    function addLog(message, type = 'info') {
      const logDiv = document.getElementById('log');
      const entry = document.createElement('div');
      entry.className = `log-entry log-${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      logDiv.appendChild(entry);
      logDiv.scrollTop = logDiv.scrollHeight;
    }

    // Initialize renderer
    const renderer = new TextRenderer(mockLogger);
    addLog('TextRenderer initialized', 'success');

    // Test Functions (exposed to global scope)
    window.testBasicText = function() {
      addLog('Running: Basic Text Test', 'info');
      renderer.render({
        content: 'This is basic text with no formatting.'
      }, 'render-zone');
    };

    window.testColors = function() {
      addLog('Running: All Colors Test', 'info');
      const colors = ['primary', 'secondary', 'info', 'success', 'warning', 'error'];
      colors.forEach(color => {
        renderer.render({
          content: `This text uses the ${color} color`,
          color: color
        }, 'render-zone');
      });
    };

    window.testIndent = function() {
      addLog('Running: Indent Levels Test', 'info');
      renderer.render({ content: 'Indent 0 (flush left)', indent: 0 }, 'render-zone');
      renderer.render({ content: 'Indent 1 (1rem)', indent: 1 }, 'render-zone');
      renderer.render({ content: 'Indent 2 (2rem)', indent: 2 }, 'render-zone');
      renderer.render({ content: 'Indent 3 (3rem)', indent: 3 }, 'render-zone');
      renderer.render({ content: 'Indent 4 (4rem)', indent: 4 }, 'render-zone');
    };

    window.testCustomClass = function() {
      addLog('Running: Custom Class Test', 'info');
      renderer.render({
        content: 'This text uses the zLead custom class (larger text)',
        class: 'zLead'
      }, 'render-zone');
      renderer.render({
        content: 'This text uses zText-center for alignment',
        class: 'zText-center'
      }, 'render-zone');
    };

    window.testMixed = function() {
      addLog('Running: Mixed Features Test', 'info');
      renderer.render({
        content: 'Primary color with indent 1',
        color: 'primary',
        indent: 1
      }, 'render-zone');
      renderer.render({
        content: 'Success color with indent 2',
        color: 'success',
        indent: 2
      }, 'render-zone');
      renderer.render({
        content: 'Warning with indent 3 and custom class',
        color: 'warning',
        indent: 3,
        class: 'zFw-bold'
      }, 'render-zone');
    };

    window.clearRenderZone = function() {
      addLog('Clearing render zone', 'info');
      const zone = document.getElementById('render-zone');
      zone.innerHTML = '<p class="zText-muted"><em>Zone cleared. Click a test button...</em></p>';
    };

    // Auto-run basic test on load
    addLog('Ready! Click a test button to start.', 'success');
  </script>
</body>
</html>

