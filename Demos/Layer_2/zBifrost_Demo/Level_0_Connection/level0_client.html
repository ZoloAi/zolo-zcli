<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level 0: Hello zBlog</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Development: Local path (updated for new folder structure) -->
    <script src="../../../../zCLI/subsystems/zComm/zComm_modules/bifrost/client/src/bifrost_client.js"></script>
    
    <!-- Production: CDN (use for deployment) -->
    <script src="https://cdn.jsdelivr.net/gh/ZoloAi/zolo-zcli@main/zCLI/subsystems/zComm/zComm_modules/bifrost/client/src/bifrost_client.js"></script>
</head>
<body>
    <div class="container">
        <h1>üåâ Level 0: Hello zBlog</h1>
        <p class="subtitle">Your first WebSocket connection!</p>
    
        <div class="goal">
            <strong>üéØ Goal:</strong> Connect to the zBlog server and see a welcome message. That's it!
    </div>

    <div id="status" class="status disconnected">
            ‚ùå Not Connected
    </div>

        <div id="messageBox" class="message-box">
            Waiting for connection...
    </div>

        <div class="buttons">
            <button id="connectBtn" class="btn-connect" onclick="connect()">
                üöÄ Connect to Server
            </button>
            <button id="disconnectBtn" class="btn-disconnect" onclick="disconnect()" disabled>
                üëã Disconnect
            </button>
        </div>
        
        <div class="instructions">
            <h3>üìã Instructions</h3>
            <ol>
                <li>Make sure <code>level0_backend.py</code> is running</li>
                <li>Click the "Connect to Server" button above</li>
                <li>You should see a welcome message from zBlog!</li>
                <li>Click "Disconnect" when done</li>
            </ol>
        </div>
    </div>

    <script>
                // Initialize BifrostClient with hooks
        // Note: Error display and zDisplay renderer auto-initialize on connect()
        const client = new BifrostClient('ws://127.0.0.1:8765', {
            autoTheme: false,  // We have our own custom styles
            debug: true,       // Show console logs for learning
            showErrors: true,  // Enable visual error display (NEW!)
            hooks: {
                onConnected: (info) => {
                    console.log('‚úÖ Connected!', info);
                    showConnected();
                },
                onDisconnected: (reason) => {
                    console.log('‚ùå Disconnected:', reason);
                    showDisconnected();
                },
                onMessage: (msg) => {
                    console.log('üì® Message received:', msg);
                    if (msg.event === 'connection_info') {
                        showWelcome();
                    }
                },
                onError: (error) => {
                    console.error('‚ö†Ô∏è Error:', error);
                    showError();
                }
            }
        });

        // Connect button handler
        async function connect() {
            document.getElementById('connectBtn').disabled = true;
            try {
                await client.connect();
            } catch (error) {
                console.error('Connection failed:', error);
                document.getElementById('connectBtn').disabled = false;
            }
        }

        // Disconnect button handler
        function disconnect() {
                client.disconnect();
        }
        
        // UI update functions
        function showConnected() {
            const statusDiv = document.getElementById('status');
            statusDiv.className = 'status connected';
            statusDiv.textContent = '‚úÖ Connected to zBlog!';
            document.getElementById('disconnectBtn').disabled = false;
        }

        function showDisconnected() {
            const statusDiv = document.getElementById('status');
            const messageBox = document.getElementById('messageBox');
            statusDiv.className = 'status disconnected';
            statusDiv.textContent = '‚ùå Not Connected';
            messageBox.className = 'message-box';
            messageBox.textContent = 'Waiting for connection...';
            document.getElementById('connectBtn').disabled = false;
            document.getElementById('disconnectBtn').disabled = true;
        }
        
        function showWelcome() {
            const messageBox = document.getElementById('messageBox');
            messageBox.className = 'message-box has-message';
            messageBox.innerHTML = `
                <div>
                    <div class="success-icon">üéâ</div>
                    <div><strong>Hello from zBlog!</strong></div>
                    <div style="margin-top: 10px; font-size: 0.9em;">
                        You're connected and ready to build your blog!
                    </div>
                </div>
            `;
        }
        
        function showError() {
            const messageBox = document.getElementById('messageBox');
            messageBox.className = 'message-box has-message';
            messageBox.style.background = '#f44336';
            messageBox.textContent = '‚ùå Connection failed! Is the server running?';
        }
        
        // Log when page loads
        console.log('Level 0: Hello zBlog');
        console.log('Click "Connect to Server" to start!');
    </script>
</body>
</html>
