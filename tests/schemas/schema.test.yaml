# tests/schemas/schema.test.yaml
# Test schema for zCLI CRUD test suite
# Simplified version with only fields needed for testing

zUsers:
  id:
    type: str
    pk: true
    source: generate_id(zU)
    required: true

  username:
    type: str
    unique: true
    required: true

  email:
    type: str
    unique: true
    required: true
    rules:
      format: email
      error_message: "Please provide a valid email address"

  password:
    type: str
    required: true
    rules:
      min_length: 4
      error_message: "Password must be at least 4 characters long"

  role:
    type: enum
    options: [zAdmin, zBuilder, zUser]
    default: zUser
    required: true

  created_at:
    type: datetime
    default: now
    required: true


zApps:
  id:
    type: str
    pk: true
    source: generate_id(zA)
    fk: zApps.id  # Self-reference for picker in delete operations
    required: true

  name:
    type: str
    unique: true
    required: true

  type:
    type: enum
    options: [web, desktop, mobile]
    default: web
    required: true

  version:
    type: str
    default: "1.0.0"

  created_at:
    type: datetime
    default: now
    required: true


zUserApps:
  id:
    type: str
    pk: true
    source: generate_id(zUA)
    required: true

  user_id:
    type: str
    fk: zUsers.id
    on_delete: CASCADE
    source: test.schemas.schema.test.zUsers
    required: true

  app_id:
    type: str
    fk: zApps.id
    on_delete: CASCADE
    source: test.schemas.schema.test.zApps
    required: true

  role:
    type: str
    default: "viewer"


Meta:
  Data_Type: sqlite
  Data_path: tests/test_data.db

